<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Develop a Reusable Framework to Spot-Check Algorithms in Python</title>
<link href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Develop a Reusable Framework to Spot-Check Algorithms in Python" property="og:title"/>
<meta content="Spot-checking algorithms is a technique in applied machine learning designed to quickly and objectively provide a first set of results on a new predictive modeling problem. Unlike grid searching and other types of algorithm tuning that seek the optimal algorithm or optimal configuration for an algorithm, spot-checking is intended to evaluate a diverse set of …" property="og:description"/>
<meta content="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Python Machine Learning" property="article:section"/>
<meta content="2018-09-13T19:00:31+00:00" property="article:published_time"/>
<meta content="2018-07-02T21:53:43+00:00" property="article:modified_time"/>
<meta content="2018-07-02T21:53:43+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem.png" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="480" property="og:image:height"/>
<meta content="Boxplot of top 10 Spot-Checking Algorithms on a Classification Problem" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Develop a Reusable Framework to Spot-Check Algorithms in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=6184" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fspot-check-machine-learning-algorithms-in-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fspot-check-machine-learning-algorithms-in-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-6184 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-33"> <div class="textwidget"><p>Want help with Python and scikit-learn? <a href="https://machinelearningmastery.lpages.co/python-machine-learning-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-6184 post type-post status-publish format-standard has-post-thumbnail hentry category-python-machine-learning">
<header>
<h1 class="title entry-title">How to Develop a Reusable Framework to Spot-Check Algorithms in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2018-09-14T05:00:31+1100">September 14, 2018</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/python-machine-learning/" title="View all items in Python Machine Learning">Python Machine Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6184 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Reusable+Framework+to+Spot-Check+Algorithms+in+Python&amp;url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p><a href="https://machinelearningmastery.com/spot-check-classification-machine-learning-algorithms-python-scikit-learn/">Spot-checking algorithms</a> is a technique in applied machine learning designed to quickly and objectively provide a first set of results on a new predictive modeling problem.</p>
<p>Unlike grid searching and other types of algorithm tuning that seek the optimal algorithm or optimal configuration for an algorithm, spot-checking is intended to evaluate a diverse set of algorithms rapidly and provide a rough first-cut result. This first cut result may be used to get an idea if a problem or problem representation is indeed predictable, and if so, the types of algorithms that may be worth investigating further for the problem.</p>
<p>Spot-checking is an approach to help overcome the “<a href="https://machinelearningmastery.com/applied-machine-learning-is-hard/">hard problem</a>” of applied machine learning and encourage you to clearly think about the <a href="https://machinelearningmastery.com/applied-machine-learning-as-a-search-problem/">higher-order search problem</a> being performed in any machine learning project.</p>
<p>In this tutorial, you will discover the usefulness of spot-checking algorithms on a new predictive modeling problem and how to develop a standard framework for spot-checking algorithms in python for classification and regression problems.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>Spot-checking provides a way to quickly discover the types of algorithms that perform well on your predictive modeling problem.</li>
<li>How to develop a generic framework for loading data, defining models, evaluating models, and summarizing results.</li>
<li>How to apply the framework for classification and regression problems.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_6195" style="width: 650px"><img alt="How to Develop a Reusable Framework for Spot-Check Algorithms in Python" class="size-full wp-image-6195" height="360" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/How-to-Develop-a-Reusable-Framework-for-Spot-Check-Algorithms-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/How-to-Develop-a-Reusable-Framework-for-Spot-Check-Algorithms-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/How-to-Develop-a-Reusable-Framework-for-Spot-Check-Algorithms-in-Python-300x169.jpg 300w" width="640"/><p class="wp-caption-text">How to Develop a Reusable Framework for Spot-Check Algorithms in Python<br/>Photo by <a href="https://www.flickr.com/photos/respres/16216077206/">Jeff Turner</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>Spot-Check Algorithms</li>
<li>Spot-Checking Framework in Python</li>
<li>Spot-Checking for Classification</li>
<li>Spot-Checking for Regression</li>
<li>Framework Extension</li>
</ol>
<h2>1. Spot-Check Algorithms</h2>
<p>We cannot know beforehand what algorithms will perform well on a given predictive modeling problem.</p>
<p>This is the <a href="https://machinelearningmastery.com/applied-machine-learning-is-hard/">hard part of applied machine learning</a> that can only be resolved via systematic experimentation.</p>
<p><a href="https://machinelearningmastery.com/why-you-should-be-spot-checking-algorithms-on-your-machine-learning-problems/">Spot-checking</a> is an approach to this problem.</p>
<p>It involves rapidly testing a large suite of diverse machine learning algorithms on a problem in order to quickly discover what algorithms might work and where to focus attention.</p>
<ul>
<li><strong>It is fast</strong>; it by-passes the days or weeks of preparation and analysis and playing with algorithms that may not ever lead to a result.</li>
<li><strong>It is objective</strong>, allowing you to discover what might work well for a problem rather than going with what you used last time.</li>
<li><strong>It gets results</strong>; you will actually fit models, make predictions and know if your problem can be predicted and what baseline skill may look like.</li>
</ul>
<p>Spot-checking may require that you work with a small sample of your dataset in order to turn around results quickly.</p>
<p>Finally, the results from spot checking are a jumping-off point. A starting point. They suggest where to focus attention on the problem, not what the best algorithm might be. The process is designed to shake you out of typical thinking and analysis and instead focus on results.</p>
<p>You can learn more about spot-checking in the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/why-you-should-be-spot-checking-algorithms-on-your-machine-learning-problems/">Why You Should be Spot-Checking Algorithms on your Machine Learning Problems</a></li>
</ul>
<p>Now that we know what spot-checking is, let’s look at how we can systematically perform spot-checking in Python.</p>
<h2>2. Spot-Checking Framework in Python</h2>
<p>In this section we will build a framework for a script that can be used for spot-checking machine learning algorithms on a classification or regression problem.</p>
<p>There are four parts to the framework that we need to develop; they are:</p>
<ul>
<li>Load Dataset</li>
<li>Define Models</li>
<li>Evaluate Models</li>
<li>Summarize Results</li>
</ul>
<p>Let’s take a look at each in turn.</p>
<h3>Load Dataset</h3>
<p>The first step of the framework is to load the data.</p>
<p>The function must be implemented for a given problem and be specialized to that problem. It will likely involve loading data from one or more CSV files.</p>
<p>We will call this function <em>load_data()</em>; it will take no arguments and return the inputs (<em>X</em>) and outputs (<em>y</em>) for the prediction problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424568577313137" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the dataset, returns X and y elements
def load_dataset():
	X, y = None, None
	return X, y</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424568577313137-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424568577313137-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424568577313137-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424568577313137-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424568577313137-1"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424568577313137-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424568577313137-3"><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424568577313137-4"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h3>Define Models</h3>
<p>The next step is to define the models to evaluate on the predictive modeling problem.</p>
<p>The models defined will be specific to the type predictive modeling problem, e.g. classification or regression.</p>
<p>The defined models should be diverse, including a mixture of:</p>
<ul>
<li>Linear Models.</li>
<li>Nonlinear Models.</li>
<li>Ensemble Models.</li>
</ul>
<p>Each model should be a given a good chance to perform well on the problem. This might be mean providing a few variations of the model with different common or well known configurations that perform well on average.</p>
<p>We will call this function <em>define_models()</em>. It will return a dictionary of model names mapped to scikit-learn model object. The name should be short, like ‘<em>svm</em>‘ and may include a configuration detail, e.g. ‘knn-7’.</p>
<p>The function will also take a dictionary as an optional argument; if not provided, a new dictionary is created and populated. If a dictionary is provided, models are added to it.</p>
<p>This is to add flexibility if you would like to have multiple functions for defining models, or add a large number of models of a specific type with different configurations.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424571324589123" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# ...
	return models</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424571324589123-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424571324589123-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424571324589123-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424571324589123-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424571324589123-1"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424571324589123-2"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424571324589123-3"><span class="crayon-h"> </span><span class="crayon-p"># ...</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424571324589123-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The idea is not to grid search model parameters; that can come later.</p>
<p>Instead, each model should be given an opportunity to perform well (i.e. not optimally). This might mean trying many combinations of parameters in some cases, e.g. in the case of gradient boosting.</p>
<h3>Evaluate Models</h3>
<p>The next step is the evaluation of the defined models on the loaded dataset.</p>
<p>The scikit-learn library provides the ability to pipeline models during evaluation. This allows the data to be transformed prior to being used to fit a model, and this is done in a correct way such that the transforms are prepared on the training data and applied to the test data.</p>
<p>We can define a function that prepares a given model prior to evaluation to allow specific transforms to be used during the spot checking process. They will be performed in a blanket way to all models. This can be useful to perform operations such as standardization, normalization, and feature selection.</p>
<p>We will define a function named <em>make_pipeline()</em> that takes a defined model and returns a pipeline. Below is an example of preparing a pipeline that will first standardize the input data, then normalize it prior to fitting the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424573970608509" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a feature preparation pipeline for a model
def make_pipeline(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424573970608509-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424573970608509-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424573970608509-1"><span class="crayon-p"># create a feature preparation pipeline for a model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-2"><span class="crayon-e">def </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424573970608509-3"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-4"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca42424573970608509-5"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-6"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca42424573970608509-7"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-8"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca42424573970608509-9"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-10"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424573970608509-11"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424573970608509-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>This function can be expanded to add other transforms, or simplified to return the provided model with no transforms.</p>
<p>Now we need to evaluate a prepared model.</p>
<p>We will use a standard of evaluating models using k-fold cross-validation. The evaluation of each defined model will result in a list of results. This is because 10 different versions of the model will have been fit and evaluated, resulting in a list of k scores.</p>
<p>We will define a function named <em>evaluate_model()</em> that will take the data, a defined model, a number of folds, and a performance metric used to evaluate the results. It will return the list of scores.</p>
<p>The function calls <em>make_pipeline()</em> for the defined model to prepare any data transforms required, then calls the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html">cross_val_score()</a> scikit-learn function. Importantly, the <em>n_jobs</em> argument is set to -1 to allow the model evaluations to occur in parallel, harnessing as many cores as you have available on your hardware.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424575041150483" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a single model
def evaluate_model(X, y, model, folds, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
	return scores</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424575041150483-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424575041150483-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424575041150483-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424575041150483-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424575041150483-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424575041150483-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424575041150483-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424575041150483-1"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424575041150483-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424575041150483-3"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424575041150483-4"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424575041150483-5"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424575041150483-6"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424575041150483-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>It is possible for the evaluation of a model to fail with an exception. I have seen this especially in the case of some models from the statsmodels library.</p>
<p>It is also possible for the evaluation of a model to result in a lot of warning messages. I have seen this especially in the case of using XGBoost models.</p>
<p>We do not care about exceptions or warnings when spot checking. We only want to know what does work and what works well. Therefore, we can trap exceptions and ignore all warnings when evaluating each model.</p>
<p>The function named <em>robust_evaluate_model()</em> implements this behavior. The <em>evaluate_model()</em> is called in a way that traps exceptions and ignores warnings. If an exception occurs and no result was possible for a given model, a <em>None</em> result is returned.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424577369523061" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a model and try to trap errors and and hide warnings
def robust_evaluate_model(X, y, model, folds, metric):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, metric)
	except:
		scores = None
	return scores</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424577369523061-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424577369523061-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424577369523061-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424577369523061-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424577369523061-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424577369523061-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424577369523061-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424577369523061-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424577369523061-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424577369523061-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424577369523061-1"><span class="crayon-p"># evaluate a model and try to trap errors and and hide warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424577369523061-2"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424577369523061-3"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424577369523061-4"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424577369523061-5"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424577369523061-6"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424577369523061-7"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424577369523061-8"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424577369523061-9"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424577369523061-10"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Finally, we can define the top-level function for evaluating the list of defined models.</p>
<p>We will define a function named <em>evaluate_models()</em> that takes the dictionary of models as an argument and returns a dictionary of model names to lists of results.</p>
<p>The number of folds in the cross-validation process can be specified by an optional argument that defaults to 10. The metric calculated on the predictions from the model can also be specified by an optional argument and defaults to classification accuracy.</p>
<p>For a full list of supported metrics, see this list:</p>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter">The scoring parameter: defining model evaluation rules, scikit-learn</a>.</li>
</ul>
<p>Any None results are skipped and not added to the dictionary of results.</p>
<p>Importantly, we provide some verbose output, summarizing the mean and standard deviation of each model after it was evaluated. This is helpful if the spot checking process on your dataset takes minutes to hours.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424579351847995" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate the model
		scores = robust_evaluate_model(X, y, model, folds, metric)
		# show process
		if scores is not None:
			# store a result
			results[name] = scores
			mean_score, std_score = mean(scores), std(scores)
			print('&gt;%s: %.3f (+/-%.3f)' % (name, mean_score, std_score))
		else:
			print('&gt;%s: error' % name)
	return results</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424579351847995-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424579351847995-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424579351847995-1"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-3"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-5"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-6"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-7"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-8"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-9"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-10"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-11"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-12"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-13"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424579351847995-14"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424579351847995-15"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Note that if for some reason you want to see warnings and errors, you can update the <em>evaluate_models()</em> to call the <em>evaluate_model()</em> function directly, by-passing the robust error handling. I find this useful when testing out new methods or method configurations that fail silently.</p>
<h3>Summarize Results</h3>
<p>Finally, we can evaluate the results.</p>
<p>Really, we only want to know what algorithms performed well.</p>
<p>Two useful ways to summarize the results are:</p>
<ol>
<li>Line summaries of the mean and standard deviation of the top 10 performing algorithms.</li>
<li>Box and whisker plots of the top 10 performing algorithms.</li>
</ol>
<p>The line summaries are quick and precise, although assume a well behaving Gaussian distribution, which may not be reasonable.</p>
<p>The box and whisker plots assume no distribution and provide a visual way to directly compare the distribution of scores across models in terms of median performance and spread of scores.</p>
<p>We will define a function named <em>summarize_results()</em> that takes the dictionary of results, prints the summary of results, and creates a boxplot image that is saved to file. The function takes an argument to specify if the evaluation score is maximizing, which by default is <em>True</em>. The number of results to summarize can also be provided as an optional parameter, which defaults to 10.</p>
<p>The function first orders the scores before printing the summary and creating the box and whisker plot.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242457c374954502" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-4">4</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-6">6</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-8">8</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-10">10</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-12">12</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-14">14</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-16">16</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-18">18</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-20">20</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-22">22</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-24">24</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-26">26</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457c374954502-28">28</div><div class="crayon-num" data-line="crayon-5c0ca4242457c374954502-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242457c374954502-1"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-3"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-5"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-6"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-7"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-8"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-9"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-10"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-11"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-12"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-13"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-15"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-16"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-17"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-18"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-19"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-20"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-21"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-22"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-23"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-24"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-25"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-27"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457c374954502-28"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242457c374954502-29"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Now that we have specialized a framework for spot-checking algorithms in Python, let’s look at how we can apply it to a classification problem.</p>
<h2>3. Spot-Checking for Classification</h2>
<p>We will generate a binary classification problem using the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html">make_classification() function</a>.</p>
<p>The function will generate 1,000 samples with 20 variables, with some redundant variables and two classes.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242457f982604938" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the dataset, returns X and y elements
def load_dataset():
	return make_classification(n_samples=1000, n_classes=2, random_state=1)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242457f982604938-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242457f982604938-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242457f982604938-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242457f982604938-1"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242457f982604938-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242457f982604938-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_classification</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>As a classification problem, we will try a suite of classification algorithms, specifically:</p>
<h3>Linear Algorithms</h3>
<ul>
<li>Logistic Regression</li>
<li>Ridge Regression</li>
<li>Stochastic Gradient Descent Classifier</li>
<li>Passive Aggressive Classifier</li>
</ul>
<p>I tried LDA and QDA, but they sadly crashed down in the C-code somewhere.</p>
<h3>Nonlinear Algorithms</h3>
<ul>
<li>k-Nearest Neighbors</li>
<li>Classification and Regression Trees</li>
<li>Extra Tree</li>
<li>Support Vector Machine</li>
<li>Naive Bayes</li>
</ul>
<h3>Ensemble Algorithms</h3>
<ul>
<li>AdaBoost</li>
<li>Bagged Decision Trees</li>
<li>Random Forest</li>
<li>Extra Trees</li>
<li>Gradient Boosting Machine</li>
</ul>
<p>Further, I added multiple configurations for a few of the algorithms like Ridge, kNN, and SVM in order to give them a good chance on the problem.</p>
<p>The full <em>define_models()</em> function is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424581792203434" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# linear models
	models['logistic'] = LogisticRegression()
	alpha = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['ridge-'+str(a)] = RidgeClassifier(alpha=a)
	models['sgd'] = SGDClassifier(max_iter=1000, tol=1e-3)
	models['pa'] = PassiveAggressiveClassifier(max_iter=1000, tol=1e-3)
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsClassifier(n_neighbors=k)
	models['cart'] = DecisionTreeClassifier()
	models['extra'] = ExtraTreeClassifier()
	models['svml'] = SVC(kernel='linear')
	models['svmp'] = SVC(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVC(C=c)
	models['bayes'] = GaussianNB()
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostClassifier(n_estimators=n_trees)
	models['bag'] = BaggingClassifier(n_estimators=n_trees)
	models['rf'] = RandomForestClassifier(n_estimators=n_trees)
	models['et'] = ExtraTreesClassifier(n_estimators=n_trees)
	models['gbm'] = GradientBoostingClassifier(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-16">16</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-18">18</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-20">20</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-22">22</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-24">24</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-26">26</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-28">28</div><div class="crayon-num" data-line="crayon-5c0ca42424581792203434-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424581792203434-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424581792203434-1"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-2"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-3"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-4"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-5"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-7"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-8"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-9"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-10"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-11"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-13"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-14"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-15"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-16"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-17"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-18"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-20"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-21"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bayes'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GaussianNB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-22"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-23"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-24"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-25"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-26"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-27"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-28"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424581792203434-29"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424581792203434-30"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>That’s it; we are now ready to spot check algorithms on the problem.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424584524885367" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# binary classification spot check script
import warnings
from numpy import mean
from numpy import std
from matplotlib import pyplot
from sklearn.datasets import make_classification
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression
from sklearn.linear_model import RidgeClassifier
from sklearn.linear_model import SGDClassifier
from sklearn.linear_model import PassiveAggressiveClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.tree import ExtraTreeClassifier
from sklearn.svm import SVC
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import BaggingClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import GradientBoostingClassifier

# load the dataset, returns X and y elements
def load_dataset():
	return make_classification(n_samples=1000, n_classes=2, random_state=1)

# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# linear models
	models['logistic'] = LogisticRegression()
	alpha = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['ridge-'+str(a)] = RidgeClassifier(alpha=a)
	models['sgd'] = SGDClassifier(max_iter=1000, tol=1e-3)
	models['pa'] = PassiveAggressiveClassifier(max_iter=1000, tol=1e-3)
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsClassifier(n_neighbors=k)
	models['cart'] = DecisionTreeClassifier()
	models['extra'] = ExtraTreeClassifier()
	models['svml'] = SVC(kernel='linear')
	models['svmp'] = SVC(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVC(C=c)
	models['bayes'] = GaussianNB()
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostClassifier(n_estimators=n_trees)
	models['bag'] = BaggingClassifier(n_estimators=n_trees)
	models['rf'] = RandomForestClassifier(n_estimators=n_trees)
	models['et'] = ExtraTreesClassifier(n_estimators=n_trees)
	models['gbm'] = GradientBoostingClassifier(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models

# create a feature preparation pipeline for a model
def make_pipeline(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# evaluate a single model
def evaluate_model(X, y, model, folds, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
	return scores

# evaluate a model and try to trap errors and and hide warnings
def robust_evaluate_model(X, y, model, folds, metric):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, metric)
	except:
		scores = None
	return scores

# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate the model
		scores = robust_evaluate_model(X, y, model, folds, metric)
		# show process
		if scores is not None:
			# store a result
			results[name] = scores
			mean_score, std_score = mean(scores), std(scores)
			print('&gt;%s: %.3f (+/-%.3f)' % (name, mean_score, std_score))
		else:
			print('&gt;%s: error' % name)
	return results

# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')

# load dataset
X, y = load_dataset()
# get model list
models = define_models()
# evaluate models
results = evaluate_models(X, y, models)
# summarize results
summarize_results(results)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-16">16</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-18">18</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-20">20</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-22">22</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-24">24</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-26">26</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-28">28</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-30">30</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-32">32</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-34">34</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-36">36</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-38">38</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-40">40</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-42">42</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-44">44</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-46">46</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-48">48</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-50">50</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-52">52</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-54">54</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-56">56</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-58">58</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-60">60</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-62">62</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-64">64</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-66">66</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-68">68</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-70">70</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-72">72</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-74">74</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-76">76</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-78">78</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-80">80</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-82">82</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-84">84</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-86">86</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-88">88</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-90">90</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-92">92</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-94">94</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-96">96</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-98">98</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-100">100</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-102">102</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-104">104</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-106">106</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-108">108</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-110">110</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-112">112</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-114">114</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-116">116</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-118">118</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-120">120</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-122">122</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-124">124</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-126">126</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-128">128</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-130">130</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-132">132</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-134">134</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-136">136</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-138">138</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-140">140</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-142">142</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-144">144</div><div class="crayon-num" data-line="crayon-5c0ca42424584524885367-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424584524885367-146">146</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424584524885367-1"><span class="crayon-p"># binary classification spot check script</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-2"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">make_classification</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">RidgeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">SGDClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">PassiveAggressiveClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-15"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-16"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-17"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-18"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-19"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">naive_bayes </span><span class="crayon-e">import </span><span class="crayon-e">GaussianNB</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-20"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-21"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-22"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-23"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-24"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-v">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-26"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-27"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-28"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_classification</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-30"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-31"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-32"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-33"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-34"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-35"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-36"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-37"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-38"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-39"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-40"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-41"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-42"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-43"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-44"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-45"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-46"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-47"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-48"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-49"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-50"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bayes'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GaussianNB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-51"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-52"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-53"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-54"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-55"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-56"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-57"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-58"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-59"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-60"> </div><div class="crayon-line" id="crayon-5c0ca42424584524885367-61"><span class="crayon-p"># create a feature preparation pipeline for a model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-62"><span class="crayon-e">def </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-63"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-64"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-65"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-66"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-67"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-68"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-69"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-70"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-71"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-72"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-74"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-75"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-76"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-77"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-78"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-79"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-80"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-81"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-82"><span class="crayon-p"># evaluate a model and try to trap errors and and hide warnings</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-83"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-84"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-85"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-86"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-87"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-88"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-89"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-90"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-91"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-92"> </div><div class="crayon-line" id="crayon-5c0ca42424584524885367-93"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-94"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-95"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-96"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-97"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-98"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-99"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-100"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-101"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-102"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-103"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-104"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-105"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-106"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-107"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-108"> </div><div class="crayon-line" id="crayon-5c0ca42424584524885367-109"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-110"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-111"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-112"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-113"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-114"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-115"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-116"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-117"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-118"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-119"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-120"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-121"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-122"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-123"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-124"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-125"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-126"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-127"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-128"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-129"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-130"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-131"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-132"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-133"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-134"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-135"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-136"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-137"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-138"> </div><div class="crayon-line" id="crayon-5c0ca42424584524885367-139"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-140"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-141"><span class="crayon-p"># get model list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-142"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-143"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-144"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424584524885367-145"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424584524885367-146"><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0077 seconds] -->
<p>Running the example prints one line per evaluated model, ending with a summary of the top 10 performing algorithms on the problem.</p>
<p>We can see that ensembles of decision trees performed the best for this problem. This suggests a few things:</p>
<ul>
<li>Ensembles of decision trees might be a good place to focus attention.</li>
<li>Gradient boosting will likely do well if further tuned.</li>
<li>A “good” performance on the problem is about 86% accuracy.</li>
<li>The relatively high performance of ridge regression suggests the need for feature selection.</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424587254268880" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;bag: 0.862 (+/-0.034)
&gt;rf: 0.865 (+/-0.033)
&gt;et: 0.858 (+/-0.035)
&gt;gbm: 0.867 (+/-0.044)

Rank=1, Name=gbm, Score=0.867 (+/- 0.044)
Rank=2, Name=rf, Score=0.865 (+/- 0.033)
Rank=3, Name=bag, Score=0.862 (+/- 0.034)
Rank=4, Name=et, Score=0.858 (+/- 0.035)
Rank=5, Name=ada, Score=0.850 (+/- 0.035)
Rank=6, Name=ridge-0.9, Score=0.848 (+/- 0.038)
Rank=7, Name=ridge-0.8, Score=0.848 (+/- 0.038)
Rank=8, Name=ridge-0.7, Score=0.848 (+/- 0.038)
Rank=9, Name=ridge-0.6, Score=0.848 (+/- 0.038)
Rank=10, Name=ridge-0.5, Score=0.848 (+/- 0.038)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424587254268880-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424587254268880-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424587254268880-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-2">&gt;bag: 0.862 (+/-0.034)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-3">&gt;rf: 0.865 (+/-0.033)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-4">&gt;et: 0.858 (+/-0.035)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-5">&gt;gbm: 0.867 (+/-0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-6"> </div><div class="crayon-line" id="crayon-5c0ca42424587254268880-7">Rank=1, Name=gbm, Score=0.867 (+/- 0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-8">Rank=2, Name=rf, Score=0.865 (+/- 0.033)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-9">Rank=3, Name=bag, Score=0.862 (+/- 0.034)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-10">Rank=4, Name=et, Score=0.858 (+/- 0.035)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-11">Rank=5, Name=ada, Score=0.850 (+/- 0.035)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-12">Rank=6, Name=ridge-0.9, Score=0.848 (+/- 0.038)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-13">Rank=7, Name=ridge-0.8, Score=0.848 (+/- 0.038)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-14">Rank=8, Name=ridge-0.7, Score=0.848 (+/- 0.038)</div><div class="crayon-line" id="crayon-5c0ca42424587254268880-15">Rank=9, Name=ridge-0.6, Score=0.848 (+/- 0.038)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424587254268880-16">Rank=10, Name=ridge-0.5, Score=0.848 (+/- 0.038)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A box and whisker plot is also created to summarize the results of the top 10 well performing algorithms.</p>
<p>The plot shows the elevation of the methods comprised of ensembles of decision trees. The plot enforces the notion that further attention on these methods would be a good idea.</p>
<div class="wp-caption aligncenter" id="attachment_6192" style="width: 650px"><img alt="Boxplot of top 10 Spot-Checking Algorithms on a Classification Problem" class="size-full wp-image-6192" height="480" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem.png 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem-300x225.png 300w" width="640"/><p class="wp-caption-text">Boxplot of top 10 Spot-Checking Algorithms on a Classification Problem</p></div>
<p>If this were a real classification problem, I would follow-up with further spot checks, such as:</p>
<ul>
<li>Spot check with various different feature selection methods.</li>
<li>Spot check without data scaling methods.</li>
<li>Spot check with a course grid of configurations for gradient boosting in sklearn or XGBoost.</li>
</ul>
<p>Next, we will see how we can apply the framework to a regression problem.</p>
<h2>4. Spot-Checking for Regression</h2>
<p>We can explore the same framework for regression predictive modeling problems with only very minor changes.</p>
<p>We can use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_regression.html#sklearn.datasets.make_regression">make_regression() function</a> to generate a contrived regression problem with 1,000 examples and 50 features, some of them redundant.</p>
<p>The defined <em>load_dataset()</em> function is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242458a293063009" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the dataset, returns X and y elements
def load_dataset():
	return make_regression(n_samples=1000, n_features=50, noise=0.1, random_state=1)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242458a293063009-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458a293063009-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242458a293063009-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242458a293063009-1"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458a293063009-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458a293063009-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_regression</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">noise</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can then specify a <em>get_models()</em> function that defines a suite of regression methods.</p>
<p>Scikit-learn does offer a wide range of linear regression methods, which is excellent. Not all of them may be required on your problem. I would recommend a minimum of linear regression and elastic net, the latter with a good suite of alpha and lambda parameters.</p>
<p>Nevertheless, we will test the full suite of methods on this problem, including:</p>
<h3>Linear Algorithms</h3>
<ul>
<li>Linear Regression</li>
<li>Lasso Regression</li>
<li>Ridge Regression</li>
<li>Elastic Net Regression</li>
<li>Huber Regression</li>
<li>LARS Regression</li>
<li>Lasso LARS Regression</li>
<li>Passive Aggressive Regression</li>
<li>RANSAC Regressor</li>
<li>Stochastic Gradient Descent Regression</li>
<li>Theil Regression</li>
</ul>
<h3>Nonlinear Algorithms</h3>
<ul>
<li>k-Nearest Neighbors</li>
<li>Classification and Regression Tree</li>
<li>Extra Tree</li>
<li>Support Vector Regression</li>
</ul>
<h3>Ensemble Algorithms</h3>
<ul>
<li>AdaBoost</li>
<li>Bagged Decision Trees</li>
<li>Random Forest</li>
<li>Extra Trees</li>
<li>Gradient Boosting Machines</li>
</ul>
<p>The full <em>get_models()</em> function is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242458c545726293" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a dict of standard models to evaluate {name:object}
def get_models(models=dict()):
	# linear models
	models['lr'] = LinearRegression()
	alpha = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['lasso-'+str(a)] = Lasso(alpha=a)
	for a in alpha:
		models['ridge-'+str(a)] = Ridge(alpha=a)
	for a1 in alpha:
		for a2 in alpha:
			name = 'en-' + str(a1) + '-' + str(a2)
			models[name] = ElasticNet(a1, a2)
	models['huber'] = HuberRegressor()
	models['lars'] = Lars()
	models['llars'] = LassoLars()
	models['pa'] = PassiveAggressiveRegressor(max_iter=1000, tol=1e-3)
	models['ranscac'] = RANSACRegressor()
	models['sgd'] = SGDRegressor(max_iter=1000, tol=1e-3)
	models['theil'] = TheilSenRegressor()
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsRegressor(n_neighbors=k)
	models['cart'] = DecisionTreeRegressor()
	models['extra'] = ExtraTreeRegressor()
	models['svml'] = SVR(kernel='linear')
	models['svmp'] = SVR(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVR(C=c)
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostRegressor(n_estimators=n_trees)
	models['bag'] = BaggingRegressor(n_estimators=n_trees)
	models['rf'] = RandomForestRegressor(n_estimators=n_trees)
	models['et'] = ExtraTreesRegressor(n_estimators=n_trees)
	models['gbm'] = GradientBoostingRegressor(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-4">4</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-6">6</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-8">8</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-10">10</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-12">12</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-14">14</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-16">16</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-18">18</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-20">20</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-22">22</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-24">24</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-26">26</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-28">28</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-30">30</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-32">32</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-34">34</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-36">36</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-38">38</div><div class="crayon-num" data-line="crayon-5c0ca4242458c545726293-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458c545726293-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242458c545726293-1"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-2"><span class="crayon-e">def </span><span class="crayon-e">get_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-3"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-4"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lr'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-5"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-7"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lasso-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Lasso</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-9"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Ridge</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">a1 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">a2 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-12"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'en-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-13"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span><span class="crayon-sy">(</span><span class="crayon-v">a1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-14"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'huber'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">HuberRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-15"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Lars</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-16"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'llars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LassoLars</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-17"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-18"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ranscac'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RANSACRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-19"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-20"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'theil'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TheilSenRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-21"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-22"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-24"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-25"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-26"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-27"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-28"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-29"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-31"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-32"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-33"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-34"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-35"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-36"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-37"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-38"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242458c545726293-39"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458c545726293-40"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>By default, the framework uses classification accuracy as the method for evaluating model predictions.</p>
<p>This does not make sense for regression, and we can change this something more meaningful for regression, such as mean squared error. We can do this by passing the <em>metric=’neg_mean_squared_error’</em> argument when calling <em>evaluate_models()</em> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242458f760087270" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate models
results = evaluate_models(models, metric='neg_mean_squared_error')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242458f760087270-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242458f760087270-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242458f760087270-1"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242458f760087270-2"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'neg_mean_squared_error'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Note that by default scikit-learn inverts error scores so that that are maximizing instead of minimizing. This is why the mean squared error is negative and will have a negative sign when summarized. Because the score is inverted, we can continue to assume that we are maximizing scores in the <em>summarize_results()</em> function and do not need to specify <em>maximize=False</em> as we might expect when using an error metric.</p>
<p>The complete code example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424591013047784" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# regression spot check script
import warnings
from numpy import mean
from numpy import std
from matplotlib import pyplot
from sklearn.datasets import make_regression
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LinearRegression
from sklearn.linear_model import Lasso
from sklearn.linear_model import Ridge
from sklearn.linear_model import ElasticNet
from sklearn.linear_model import HuberRegressor
from sklearn.linear_model import Lars
from sklearn.linear_model import LassoLars
from sklearn.linear_model import PassiveAggressiveRegressor
from sklearn.linear_model import RANSACRegressor
from sklearn.linear_model import SGDRegressor
from sklearn.linear_model import TheilSenRegressor
from sklearn.neighbors import KNeighborsRegressor
from sklearn.tree import DecisionTreeRegressor
from sklearn.tree import ExtraTreeRegressor
from sklearn.svm import SVR
from sklearn.ensemble import AdaBoostRegressor
from sklearn.ensemble import BaggingRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.ensemble import ExtraTreesRegressor
from sklearn.ensemble import GradientBoostingRegressor

# load the dataset, returns X and y elements
def load_dataset():
	return make_regression(n_samples=1000, n_features=50, noise=0.1, random_state=1)

# create a dict of standard models to evaluate {name:object}
def get_models(models=dict()):
	# linear models
	models['lr'] = LinearRegression()
	alpha = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['lasso-'+str(a)] = Lasso(alpha=a)
	for a in alpha:
		models['ridge-'+str(a)] = Ridge(alpha=a)
	for a1 in alpha:
		for a2 in alpha:
			name = 'en-' + str(a1) + '-' + str(a2)
			models[name] = ElasticNet(a1, a2)
	models['huber'] = HuberRegressor()
	models['lars'] = Lars()
	models['llars'] = LassoLars()
	models['pa'] = PassiveAggressiveRegressor(max_iter=1000, tol=1e-3)
	models['ranscac'] = RANSACRegressor()
	models['sgd'] = SGDRegressor(max_iter=1000, tol=1e-3)
	models['theil'] = TheilSenRegressor()
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsRegressor(n_neighbors=k)
	models['cart'] = DecisionTreeRegressor()
	models['extra'] = ExtraTreeRegressor()
	models['svml'] = SVR(kernel='linear')
	models['svmp'] = SVR(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVR(C=c)
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostRegressor(n_estimators=n_trees)
	models['bag'] = BaggingRegressor(n_estimators=n_trees)
	models['rf'] = RandomForestRegressor(n_estimators=n_trees)
	models['et'] = ExtraTreesRegressor(n_estimators=n_trees)
	models['gbm'] = GradientBoostingRegressor(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models

# create a feature preparation pipeline for a model
def make_pipeline(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# evaluate a single model
def evaluate_model(X, y, model, folds, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
	return scores

# evaluate a model and try to trap errors and and hide warnings
def robust_evaluate_model(X, y, model, folds, metric):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, metric)
	except:
		scores = None
	return scores

# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate the model
		scores = robust_evaluate_model(X, y, model, folds, metric)
		# show process
		if scores is not None:
			# store a result
			results[name] = scores
			mean_score, std_score = mean(scores), std(scores)
			print('&gt;%s: %.3f (+/-%.3f)' % (name, mean_score, std_score))
		else:
			print('&gt;%s: error' % name)
	return results

# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')

# load dataset
X, y = load_dataset()
# get model list
models = get_models()
# evaluate models
results = evaluate_models(X, y, models, metric='neg_mean_squared_error')
# summarize results
summarize_results(results)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-16">16</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-18">18</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-20">20</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-22">22</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-24">24</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-26">26</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-28">28</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-30">30</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-32">32</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-34">34</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-36">36</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-38">38</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-40">40</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-42">42</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-44">44</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-46">46</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-48">48</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-50">50</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-52">52</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-54">54</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-56">56</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-58">58</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-60">60</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-62">62</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-64">64</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-66">66</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-68">68</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-70">70</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-72">72</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-74">74</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-76">76</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-78">78</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-80">80</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-82">82</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-84">84</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-86">86</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-88">88</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-90">90</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-92">92</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-94">94</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-96">96</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-98">98</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-100">100</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-102">102</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-104">104</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-106">106</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-108">108</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-110">110</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-112">112</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-114">114</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-116">116</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-118">118</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-120">120</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-122">122</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-124">124</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-126">126</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-128">128</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-130">130</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-132">132</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-134">134</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-136">136</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-138">138</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-140">140</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-142">142</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-144">144</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-146">146</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-148">148</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-150">150</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-152">152</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-154">154</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-156">156</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-158">158</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-160">160</div><div class="crayon-num" data-line="crayon-5c0ca42424591013047784-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424591013047784-162">162</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424591013047784-1"><span class="crayon-p"># regression spot check script</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-2"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">make_regression</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LinearRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">Lasso</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">Ridge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">ElasticNet</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-15"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">HuberRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-16"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">Lars</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-17"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LassoLars</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-18"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">PassiveAggressiveRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-19"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">RANSACRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-20"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">SGDRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-21"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">TheilSenRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-22"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-23"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-24"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreeRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-25"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVR</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-26"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-27"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-28"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-29"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesRegressor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-30"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-v">GradientBoostingRegressor</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-31"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-32"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-33"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-34"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_regression</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">noise</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-35"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-36"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-37"><span class="crayon-e">def </span><span class="crayon-e">get_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-38"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-39"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lr'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-40"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-41"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-42"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lasso-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Lasso</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-44"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Ridge</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-45"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">a1 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-46"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">a2 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-47"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'en-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-48"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span><span class="crayon-sy">(</span><span class="crayon-v">a1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-49"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'huber'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">HuberRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-50"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'lars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Lars</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-51"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'llars'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LassoLars</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-52"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-53"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ranscac'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RANSACRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-54"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-55"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'theil'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TheilSenRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-56"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-57"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-58"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-59"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-60"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-61"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeRegressor</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-62"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-63"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-64"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-65"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-66"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVR</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-67"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-68"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-69"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-70"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-71"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-72"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-73"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-74"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-75"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-76"> </div><div class="crayon-line" id="crayon-5c0ca42424591013047784-77"><span class="crayon-p"># create a feature preparation pipeline for a model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-78"><span class="crayon-e">def </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-79"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-80"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-81"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-82"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-83"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-84"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-85"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-86"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-87"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-88"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-89"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-90"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-91"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-92"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-93"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-94"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-95"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-96"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-97"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-98"><span class="crayon-p"># evaluate a model and try to trap errors and and hide warnings</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-99"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-100"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-101"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-102"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-103"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-104"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-105"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-106"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-107"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-108"> </div><div class="crayon-line" id="crayon-5c0ca42424591013047784-109"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-110"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-111"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-112"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-113"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-114"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-115"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-116"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-117"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-118"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-119"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-120"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-121"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-122"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-123"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-124"> </div><div class="crayon-line" id="crayon-5c0ca42424591013047784-125"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-126"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-127"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-128"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-129"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-130"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-131"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-132"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-133"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-134"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-135"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-136"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-137"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-138"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-139"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-140"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-141"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-142"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-143"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-144"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-145"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-146"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-147"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-148"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-149"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-150"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-151"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-152"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-153"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-154"> </div><div class="crayon-line" id="crayon-5c0ca42424591013047784-155"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-156"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-157"><span class="crayon-p"># get model list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-158"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_models</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-159"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-160"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'neg_mean_squared_error'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424591013047784-161"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424591013047784-162"><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0088 seconds] -->
<p>Running the example summarizes the performance of each model evaluated, then prints the performance of the top 10 well performing algorithms.</p>
<p>We can see that many of the linear algorithms perhaps found the same optimal solution on this problem. Notably those methods that performed well use regularization as a type of feature selection, allowing them to zoom in on the optimal solution.</p>
<p>This would suggest the importance of feature selection when modeling this problem and that linear methods would be the area to focus, at least for now.</p>
<p>Reviewing the printed scores of evaluated models also shows how poorly nonlinear and ensemble algorithms performed on this problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424594272515787" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;bag: -6118.084 (+/-1558.433)
&gt;rf: -6127.169 (+/-1594.392)
&gt;et: -5017.062 (+/-1037.673)
&gt;gbm: -2347.807 (+/-500.364)

Rank=1, Name=lars, Score=-0.011 (+/- 0.001)
Rank=2, Name=ranscac, Score=-0.011 (+/- 0.001)
Rank=3, Name=lr, Score=-0.011 (+/- 0.001)
Rank=4, Name=ridge-0.0, Score=-0.011 (+/- 0.001)
Rank=5, Name=en-0.0-0.1, Score=-0.011 (+/- 0.001)
Rank=6, Name=en-0.0-0.8, Score=-0.011 (+/- 0.001)
Rank=7, Name=en-0.0-0.2, Score=-0.011 (+/- 0.001)
Rank=8, Name=en-0.0-0.7, Score=-0.011 (+/- 0.001)
Rank=9, Name=en-0.0-0.0, Score=-0.011 (+/- 0.001)
Rank=10, Name=en-0.0-0.3, Score=-0.011 (+/- 0.001)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424594272515787-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424594272515787-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424594272515787-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-2">&gt;bag: -6118.084 (+/-1558.433)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-3">&gt;rf: -6127.169 (+/-1594.392)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-4">&gt;et: -5017.062 (+/-1037.673)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-5">&gt;gbm: -2347.807 (+/-500.364)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-6"> </div><div class="crayon-line" id="crayon-5c0ca42424594272515787-7">Rank=1, Name=lars, Score=-0.011 (+/- 0.001)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-8">Rank=2, Name=ranscac, Score=-0.011 (+/- 0.001)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-9">Rank=3, Name=lr, Score=-0.011 (+/- 0.001)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-10">Rank=4, Name=ridge-0.0, Score=-0.011 (+/- 0.001)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-11">Rank=5, Name=en-0.0-0.1, Score=-0.011 (+/- 0.001)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-12">Rank=6, Name=en-0.0-0.8, Score=-0.011 (+/- 0.001)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-13">Rank=7, Name=en-0.0-0.2, Score=-0.011 (+/- 0.001)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-14">Rank=8, Name=en-0.0-0.7, Score=-0.011 (+/- 0.001)</div><div class="crayon-line" id="crayon-5c0ca42424594272515787-15">Rank=9, Name=en-0.0-0.0, Score=-0.011 (+/- 0.001)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424594272515787-16">Rank=10, Name=en-0.0-0.3, Score=-0.011 (+/- 0.001)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A box and whisker plot is created, not really adding value to the analysis of results in this case.</p>
<div class="wp-caption aligncenter" id="attachment_6193" style="width: 650px"><img alt="Boxplot of top 10 Spot-Checking Algorithms on a Regression Problem" class="size-full wp-image-6193" height="480" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Regression-Problem.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Regression-Problem.png 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Regression-Problem-300x225.png 300w" width="640"/><p class="wp-caption-text">Boxplot of top 10 Spot-Checking Algorithms on a Regression Problem</p></div>
<h2>5. Framework Extension</h2>
<p>In this section, we explore some handy extensions of the spot check framework.</p>
<h3>Course Grid Search for Gradient Boosting</h3>
<p>I find myself using XGBoost and gradient boosting a lot for straight-forward classification and regression problems.</p>
<p>As such, I like to use a course grid across standard configuration parameters of the method when spot checking.</p>
<p>Below is a function to do this that can be used directly in the spot checking framework.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca42424598097534320" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define gradient boosting models
def define_gbm_models(models=dict(), use_xgb=True):
	# define config ranges
	rates = [0.001, 0.01, 0.1]
	trees = [50, 100]
	ss = [0.5, 0.7, 1.0]
	depth = [3, 7, 9]
	# add configurations
	for l in rates:
		for e in trees:
			for s in ss:
				for d in depth:
					cfg = [l, e, s, d]
					if use_xgb:
						name = 'xgb-' + str(cfg)
						models[name] = XGBClassifier(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
					else:
						name = 'gbm-' + str(cfg)
						models[name] = GradientBoostingClassifier(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
	print('Defined %d models' % len(models))
	return models</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-2">2</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-4">4</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-6">6</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-8">8</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-10">10</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-12">12</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-14">14</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-16">16</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-18">18</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca42424598097534320-20">20</div><div class="crayon-num" data-line="crayon-5c0ca42424598097534320-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca42424598097534320-1"><span class="crayon-p"># define gradient boosting models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-2"><span class="crayon-e">def </span><span class="crayon-e">define_gbm_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-3"><span class="crayon-h"> </span><span class="crayon-p"># define config ranges</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-4"><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-5"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-6"><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-7"><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-8"><span class="crayon-h"> </span><span class="crayon-p"># add configurations</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-13"><span class="crayon-h"> </span><span class="crayon-v">cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-15"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'xgb-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-16"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">XGBClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-17"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-18"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'gbm-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-19"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca42424598097534320-20"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca42424598097534320-21"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>By default, the function will use XGBoost models, but can use the sklearn gradient boosting model if the <em>use_xgb</em> argument to the function is set to <em>False</em>.</p>
<p>Again, we are not trying to optimally tune GBM on the problem, only very quickly find an area in the configuration space that may be worth investigating further.</p>
<p>This function can be used directly on classification and regression problems with only a minor change from “<em>XGBClassifier</em>” to “<em>XGBRegressor</em>” and “<em>GradientBoostingClassifier</em>” to “<em>GradientBoostingRegressor</em>“. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242459a576041592" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define gradient boosting models
def get_gbm_models(models=dict(), use_xgb=True):
	# define config ranges
	rates = [0.001, 0.01, 0.1]
	trees = [50, 100]
	ss = [0.5, 0.7, 1.0]
	depth = [3, 7, 9]
	# add configurations
	for l in rates:
		for e in trees:
			for s in ss:
				for d in depth:
					cfg = [l, e, s, d]
					if use_xgb:
						name = 'xgb-' + str(cfg)
						models[name] = XGBRegressor(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
					else:
						name = 'gbm-' + str(cfg)
						models[name] = GradientBoostingXGBRegressor(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
	print('Defined %d models' % len(models))
	return models</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-4">4</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-6">6</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-8">8</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-10">10</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-12">12</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-14">14</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-16">16</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-18">18</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459a576041592-20">20</div><div class="crayon-num" data-line="crayon-5c0ca4242459a576041592-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242459a576041592-1"><span class="crayon-p"># define gradient boosting models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-2"><span class="crayon-e">def </span><span class="crayon-e">get_gbm_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-3"><span class="crayon-h"> </span><span class="crayon-p"># define config ranges</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-4"><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-5"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-6"><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-7"><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-8"><span class="crayon-h"> </span><span class="crayon-p"># add configurations</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-13"><span class="crayon-h"> </span><span class="crayon-v">cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-15"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'xgb-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-16"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">XGBRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-17"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-18"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'gbm-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-19"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingXGBRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459a576041592-20"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459a576041592-21"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>To make this concrete, below is the binary classification example updated to also define XGBoost models.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242459c679000430" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# binary classification spot check script
import warnings
from numpy import mean
from numpy import std
from matplotlib import pyplot
from sklearn.datasets import make_classification
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression
from sklearn.linear_model import RidgeClassifier
from sklearn.linear_model import SGDClassifier
from sklearn.linear_model import PassiveAggressiveClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.tree import ExtraTreeClassifier
from sklearn.svm import SVC
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import BaggingClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import GradientBoostingClassifier
from xgboost import XGBClassifier

# load the dataset, returns X and y elements
def load_dataset():
	return make_classification(n_samples=1000, n_classes=2, random_state=1)

# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# linear models
	models['logistic'] = LogisticRegression()
	alpha = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['ridge-'+str(a)] = RidgeClassifier(alpha=a)
	models['sgd'] = SGDClassifier(max_iter=1000, tol=1e-3)
	models['pa'] = PassiveAggressiveClassifier(max_iter=1000, tol=1e-3)
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsClassifier(n_neighbors=k)
	models['cart'] = DecisionTreeClassifier()
	models['extra'] = ExtraTreeClassifier()
	models['svml'] = SVC(kernel='linear')
	models['svmp'] = SVC(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVC(C=c)
	models['bayes'] = GaussianNB()
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostClassifier(n_estimators=n_trees)
	models['bag'] = BaggingClassifier(n_estimators=n_trees)
	models['rf'] = RandomForestClassifier(n_estimators=n_trees)
	models['et'] = ExtraTreesClassifier(n_estimators=n_trees)
	models['gbm'] = GradientBoostingClassifier(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models

# define gradient boosting models
def define_gbm_models(models=dict(), use_xgb=True):
	# define config ranges
	rates = [0.001, 0.01, 0.1]
	trees = [50, 100]
	ss = [0.5, 0.7, 1.0]
	depth = [3, 7, 9]
	# add configurations
	for l in rates:
		for e in trees:
			for s in ss:
				for d in depth:
					cfg = [l, e, s, d]
					if use_xgb:
						name = 'xgb-' + str(cfg)
						models[name] = XGBClassifier(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
					else:
						name = 'gbm-' + str(cfg)
						models[name] = GradientBoostingClassifier(learning_rate=l, n_estimators=e, subsample=s, max_depth=d)
	print('Defined %d models' % len(models))
	return models

# create a feature preparation pipeline for a model
def make_pipeline(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# evaluate a single model
def evaluate_model(X, y, model, folds, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
	return scores

# evaluate a model and try to trap errors and and hide warnings
def robust_evaluate_model(X, y, model, folds, metric):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, metric)
	except:
		scores = None
	return scores

# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate the model
		scores = robust_evaluate_model(X, y, model, folds, metric)
		# show process
		if scores is not None:
			# store a result
			results[name] = scores
			mean_score, std_score = mean(scores), std(scores)
			print('&gt;%s: %.3f (+/-%.3f)' % (name, mean_score, std_score))
		else:
			print('&gt;%s: error' % name)
	return results

# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')

# load dataset
X, y = load_dataset()
# get model list
models = define_models()
# add gbm models
models = define_gbm_models(models)
# evaluate models
results = evaluate_models(X, y, models)
# summarize results
summarize_results(results)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-4">4</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-6">6</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-8">8</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-10">10</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-12">12</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-14">14</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-16">16</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-18">18</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-20">20</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-22">22</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-24">24</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-26">26</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-28">28</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-30">30</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-32">32</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-34">34</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-36">36</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-38">38</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-40">40</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-42">42</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-44">44</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-46">46</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-48">48</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-50">50</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-52">52</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-54">54</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-56">56</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-58">58</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-60">60</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-62">62</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-64">64</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-66">66</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-68">68</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-70">70</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-72">72</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-74">74</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-76">76</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-78">78</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-80">80</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-82">82</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-84">84</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-86">86</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-88">88</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-90">90</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-92">92</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-94">94</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-96">96</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-98">98</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-100">100</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-102">102</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-104">104</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-106">106</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-108">108</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-110">110</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-112">112</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-114">114</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-116">116</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-118">118</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-120">120</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-122">122</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-124">124</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-126">126</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-128">128</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-130">130</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-132">132</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-134">134</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-136">136</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-138">138</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-140">140</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-142">142</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-144">144</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-146">146</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-148">148</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-150">150</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-152">152</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-154">154</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-156">156</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-158">158</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-160">160</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-162">162</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-164">164</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-166">166</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-168">168</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459c679000430-170">170</div><div class="crayon-num" data-line="crayon-5c0ca4242459c679000430-171">171</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242459c679000430-1"><span class="crayon-p"># binary classification spot check script</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-2"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">make_classification</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">RidgeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">SGDClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">PassiveAggressiveClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-15"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-16"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-17"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-18"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-19"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">naive_bayes </span><span class="crayon-e">import </span><span class="crayon-e">GaussianNB</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-20"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-21"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-22"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-23"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-24"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-25"><span class="crayon-e">from </span><span class="crayon-e">xgboost </span><span class="crayon-e">import </span><span class="crayon-v">XGBClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-26"> </div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-27"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-28"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_classification</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-30"> </div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-31"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-32"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-33"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-34"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-35"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-36"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-37"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-38"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-39"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-40"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-41"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-42"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-43"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-44"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-45"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-46"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-47"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-48"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-49"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-50"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-51"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bayes'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GaussianNB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-52"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-53"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-54"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-55"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-56"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-57"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-58"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-59"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-60"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-61"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-62"><span class="crayon-p"># define gradient boosting models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-63"><span class="crayon-e">def </span><span class="crayon-e">define_gbm_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-64"><span class="crayon-h"> </span><span class="crayon-p"># define config ranges</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-65"><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-66"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-67"><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-68"><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-69"><span class="crayon-h"> </span><span class="crayon-p"># add configurations</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-70"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">l</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">rates</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-71"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-72"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">ss</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-73"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-74"><span class="crayon-h"> </span><span class="crayon-v">cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-75"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">use_xgb</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-76"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'xgb-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-77"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">XGBClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-78"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-79"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'gbm-'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">cfg</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-80"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-o">=</span><span class="crayon-v">l</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">e</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subsample</span><span class="crayon-o">=</span><span class="crayon-v">s</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">=</span><span class="crayon-v">d</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-81"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-82"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-83"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-84"><span class="crayon-p"># create a feature preparation pipeline for a model</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-85"><span class="crayon-e">def </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-86"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-87"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-88"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-89"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-90"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-91"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-92"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-93"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-94"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-95"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-96"> </div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-97"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-98"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-99"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-100"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-101"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-102"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-103"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-104"> </div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-105"><span class="crayon-p"># evaluate a model and try to trap errors and and hide warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-106"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-107"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-108"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-109"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-110"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-111"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-112"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-113"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-114"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-115"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-116"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-117"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-118"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-119"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-120"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-121"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-122"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-123"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-124"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-125"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-126"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-127"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-128"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-129"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-130"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-131"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-132"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-133"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-134"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-135"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-136"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-137"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-138"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-139"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-140"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-141"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-142"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-143"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-144"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-145"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-146"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-147"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-148"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-149"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-150"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-151"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-152"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-153"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-154"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-155"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-156"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-157"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-158"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-159"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-160"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-161"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-162"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-163"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-164"><span class="crayon-p"># get model list</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-165"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-166"><span class="crayon-p"># add gbm models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-167"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gbm_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-168"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-169"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459c679000430-170"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="crayon-5c0ca4242459c679000430-171"><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0094 seconds] -->
<p>Running the example shows that indeed some XGBoost models perform well on the problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca4242459f053261237" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;xgb-[0.1, 100, 1.0, 3]: 0.864 (+/-0.044)
&gt;xgb-[0.1, 100, 1.0, 7]: 0.865 (+/-0.036)
&gt;xgb-[0.1, 100, 1.0, 9]: 0.867 (+/-0.039)

Rank=1, Name=xgb-[0.1, 50, 1.0, 3], Score=0.872 (+/- 0.039)
Rank=2, Name=et, Score=0.869 (+/- 0.033)
Rank=3, Name=xgb-[0.1, 50, 1.0, 9], Score=0.868 (+/- 0.038)
Rank=4, Name=xgb-[0.1, 100, 1.0, 9], Score=0.867 (+/- 0.039)
Rank=5, Name=xgb-[0.01, 50, 1.0, 3], Score=0.867 (+/- 0.035)
Rank=6, Name=xgb-[0.1, 50, 1.0, 7], Score=0.867 (+/- 0.037)
Rank=7, Name=xgb-[0.001, 100, 0.7, 9], Score=0.866 (+/- 0.040)
Rank=8, Name=xgb-[0.01, 100, 1.0, 3], Score=0.866 (+/- 0.037)
Rank=9, Name=xgb-[0.001, 100, 0.7, 3], Score=0.866 (+/- 0.034)
Rank=10, Name=xgb-[0.01, 50, 0.7, 3], Score=0.866 (+/- 0.034)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-2">2</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-4">4</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-6">6</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-8">8</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-10">10</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-12">12</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca4242459f053261237-14">14</div><div class="crayon-num" data-line="crayon-5c0ca4242459f053261237-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca4242459f053261237-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-2">&gt;xgb-[0.1, 100, 1.0, 3]: 0.864 (+/-0.044)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-3">&gt;xgb-[0.1, 100, 1.0, 7]: 0.865 (+/-0.036)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-4">&gt;xgb-[0.1, 100, 1.0, 9]: 0.867 (+/-0.039)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-6">Rank=1, Name=xgb-[0.1, 50, 1.0, 3], Score=0.872 (+/- 0.039)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-7">Rank=2, Name=et, Score=0.869 (+/- 0.033)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-8">Rank=3, Name=xgb-[0.1, 50, 1.0, 9], Score=0.868 (+/- 0.038)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-9">Rank=4, Name=xgb-[0.1, 100, 1.0, 9], Score=0.867 (+/- 0.039)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-10">Rank=5, Name=xgb-[0.01, 50, 1.0, 3], Score=0.867 (+/- 0.035)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-11">Rank=6, Name=xgb-[0.1, 50, 1.0, 7], Score=0.867 (+/- 0.037)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-12">Rank=7, Name=xgb-[0.001, 100, 0.7, 9], Score=0.866 (+/- 0.040)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-13">Rank=8, Name=xgb-[0.01, 100, 1.0, 3], Score=0.866 (+/- 0.037)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca4242459f053261237-14">Rank=9, Name=xgb-[0.001, 100, 0.7, 3], Score=0.866 (+/- 0.034)</div><div class="crayon-line" id="crayon-5c0ca4242459f053261237-15">Rank=10, Name=xgb-[0.01, 50, 0.7, 3], Score=0.866 (+/- 0.034)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p><div class="wp-caption aligncenter" id="attachment_6194" style="width: 650px"><img alt="Boxplot of top 10 Spot-Checking Algorithms on a Classification Problem with XGBoost" class="size-full wp-image-6194" height="480" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem-with-XGBoost.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem-with-XGBoost.png 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Boxplot-of-top-10-Spot-Checking-Algorithms-on-a-Classification-Problem-with-XGBoost-300x225.png 300w" width="640"/><p class="wp-caption-text">Boxplot of top 10 Spot-Checking Algorithms on a Classification Problem with XGBoost</p></div>
<h3>Repeated Evaluations</h3>
<p>The above results also highlight the noisy nature of the evaluations, e.g. the results of extra trees in this run are different from the run above (0.858 vs 0.869).</p>
<p>We are using k-fold cross-validation to produce a population of scores, but the population is small and the calculated mean will be noisy.</p>
<p>This is fine as long as we take the spot-check results as a starting point and not definitive results of an algorithm on the problem. This is hard to do; it takes discipline in the practitioner.</p>
<p>Alternately, you may want to adapt the framework such that the model evaluation scheme better matches the model evaluation scheme you intend to use for your specific problem.</p>
<p>For example, when evaluating stochastic algorithms like bagged or boosted decision trees, it is a good idea to run each experiment multiple times on the same train/test sets (called repeats) in order to account for the stochastic nature of the learning algorithm.</p>
<p>We can update the <em>evaluate_model()</em> function to repeat the evaluation of a given model n-times, with a different split of the data each time, then return all scores. For example, three repeats of 10-fold cross-validation will result in 30 scores from each to calculate a mean performance of a model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245a2974151930" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a single model
def evaluate_model(X, y, model, folds, repeats, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = list()
	# repeat model evaluation n times
	for _ in range(repeats):
		# perform run
		scores_r = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
		# add scores to list
		scores += scores_r.tolist()
	return scores</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a2974151930-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245a2974151930-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245a2974151930-1"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-3"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-4"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-5"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-6"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-7"><span class="crayon-h"> </span><span class="crayon-p"># repeat model evaluation n times</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-9"><span class="crayon-h"> </span><span class="crayon-p"># perform run</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-10"><span class="crayon-h"> </span><span class="crayon-v">scores_r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-11"><span class="crayon-h"> </span><span class="crayon-p"># add scores to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a2974151930-12"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">scores_r</span><span class="crayon-sy">.</span><span class="crayon-e">tolist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a2974151930-13"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Alternately, you may prefer to calculate a mean score from each k-fold cross-validation run, then calculate a grand mean of all runs, as described in:</p>
<ul>
<li><a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/">How to Evaluate the Skill of Deep Learning Models</a></li>
</ul>
<p>We can then update the <em>robust_evaluate_model()</em> function to pass down the repeats argument and the <em>evaluate_models()</em> function to define a default, such as 3.</p>
<p>A complete example of the binary classification example with three repeats of model evaluation is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245a5106671520" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# binary classification spot check script
import warnings
from numpy import mean
from numpy import std
from matplotlib import pyplot
from sklearn.datasets import make_classification
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression
from sklearn.linear_model import RidgeClassifier
from sklearn.linear_model import SGDClassifier
from sklearn.linear_model import PassiveAggressiveClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.tree import ExtraTreeClassifier
from sklearn.svm import SVC
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import BaggingClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import GradientBoostingClassifier

# load the dataset, returns X and y elements
def load_dataset():
	return make_classification(n_samples=1000, n_classes=2, random_state=1)

# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# linear models
	models['logistic'] = LogisticRegression()
	alpha = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['ridge-'+str(a)] = RidgeClassifier(alpha=a)
	models['sgd'] = SGDClassifier(max_iter=1000, tol=1e-3)
	models['pa'] = PassiveAggressiveClassifier(max_iter=1000, tol=1e-3)
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsClassifier(n_neighbors=k)
	models['cart'] = DecisionTreeClassifier()
	models['extra'] = ExtraTreeClassifier()
	models['svml'] = SVC(kernel='linear')
	models['svmp'] = SVC(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVC(C=c)
	models['bayes'] = GaussianNB()
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostClassifier(n_estimators=n_trees)
	models['bag'] = BaggingClassifier(n_estimators=n_trees)
	models['rf'] = RandomForestClassifier(n_estimators=n_trees)
	models['et'] = ExtraTreesClassifier(n_estimators=n_trees)
	models['gbm'] = GradientBoostingClassifier(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models

# create a feature preparation pipeline for a model
def make_pipeline(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# evaluate a single model
def evaluate_model(X, y, model, folds, repeats, metric):
	# create the pipeline
	pipeline = make_pipeline(model)
	# evaluate model
	scores = list()
	# repeat model evaluation n times
	for _ in range(repeats):
		# perform run
		scores_r = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
		# add scores to list
		scores += scores_r.tolist()
	return scores

# evaluate a model and try to trap errors and hide warnings
def robust_evaluate_model(X, y, model, folds, repeats, metric):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, repeats, metric)
	except:
		scores = None
	return scores

# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, folds=10, repeats=3, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate the model
		scores = robust_evaluate_model(X, y, model, folds, repeats, metric)
		# show process
		if scores is not None:
			# store a result
			results[name] = scores
			mean_score, std_score = mean(scores), std(scores)
			print('&gt;%s: %.3f (+/-%.3f)' % (name, mean_score, std_score))
		else:
			print('&gt;%s: error' % name)
	return results

# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')

# load dataset
X, y = load_dataset()
# get model list
models = define_models()
# evaluate models
results = evaluate_models(X, y, models)
# summarize results
summarize_results(results)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-16">16</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-18">18</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-20">20</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-22">22</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-24">24</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-26">26</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-28">28</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-30">30</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-32">32</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-34">34</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-36">36</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-38">38</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-40">40</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-42">42</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-44">44</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-46">46</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-48">48</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-50">50</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-52">52</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-54">54</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-56">56</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-58">58</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-60">60</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-62">62</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-64">64</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-66">66</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-68">68</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-70">70</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-72">72</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-74">74</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-76">76</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-78">78</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-80">80</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-82">82</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-84">84</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-86">86</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-88">88</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-90">90</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-92">92</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-94">94</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-96">96</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-98">98</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-100">100</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-102">102</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-104">104</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-106">106</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-108">108</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-110">110</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-112">112</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-114">114</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-116">116</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-118">118</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-120">120</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-122">122</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-124">124</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-126">126</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-128">128</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-130">130</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-132">132</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-134">134</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-136">136</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-138">138</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-140">140</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-142">142</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-144">144</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-146">146</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-148">148</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-150">150</div><div class="crayon-num" data-line="crayon-5c0ca424245a5106671520-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a5106671520-152">152</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245a5106671520-1"><span class="crayon-p"># binary classification spot check script</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-2"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">make_classification</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">RidgeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">SGDClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">PassiveAggressiveClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-15"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-16"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-17"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-18"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-19"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">naive_bayes </span><span class="crayon-e">import </span><span class="crayon-e">GaussianNB</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-20"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-21"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-22"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-23"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-24"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-v">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-26"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-27"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-28"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_classification</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-30"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-31"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-32"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-33"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-34"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-35"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-36"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-37"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-38"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-39"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-40"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-41"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-42"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-43"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-44"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-45"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-46"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-47"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-48"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-49"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-50"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bayes'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GaussianNB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-51"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-52"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-53"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-54"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-55"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-56"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-57"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-58"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-59"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-60"> </div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-61"><span class="crayon-p"># create a feature preparation pipeline for a model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-62"><span class="crayon-e">def </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-63"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-64"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-65"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-66"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-67"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-68"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-69"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-70"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-71"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-72"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-74"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-75"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-76"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-77"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">make_pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-78"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-79"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-80"><span class="crayon-h"> </span><span class="crayon-p"># repeat model evaluation n times</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-81"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-82"><span class="crayon-h"> </span><span class="crayon-p"># perform run</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-83"><span class="crayon-h"> </span><span class="crayon-v">scores_r</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-84"><span class="crayon-h"> </span><span class="crayon-p"># add scores to list</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-85"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">scores_r</span><span class="crayon-sy">.</span><span class="crayon-e">tolist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-86"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-87"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-88"><span class="crayon-p"># evaluate a model and try to trap errors and hide warnings</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-89"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-90"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-91"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-92"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-93"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-94"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-95"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-96"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-97"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-98"> </div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-99"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-100"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-101"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-102"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-103"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-104"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-105"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-106"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-107"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-108"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-109"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-110"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-111"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-112"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-113"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-114"> </div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-115"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-116"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-117"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-118"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-119"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-120"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-121"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-122"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-123"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-124"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-125"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-126"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-127"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-128"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-129"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-130"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-131"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-132"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-133"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-134"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-135"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-136"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-137"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-138"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-139"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-140"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-141"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-142"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-143"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-144"> </div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-145"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-146"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-147"><span class="crayon-p"># get model list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-148"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-149"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-150"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245a5106671520-151"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a5106671520-152"><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0084 seconds] -->
<p>Running the example produces a more robust estimate of the scores.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245a8547030750" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;bag: 0.861 (+/-0.037)
&gt;rf: 0.859 (+/-0.036)
&gt;et: 0.869 (+/-0.035)
&gt;gbm: 0.867 (+/-0.044)

Rank=1, Name=et, Score=0.869 (+/- 0.035)
Rank=2, Name=gbm, Score=0.867 (+/- 0.044)
Rank=3, Name=bag, Score=0.861 (+/- 0.037)
Rank=4, Name=rf, Score=0.859 (+/- 0.036)
Rank=5, Name=ada, Score=0.850 (+/- 0.035)
Rank=6, Name=ridge-0.9, Score=0.848 (+/- 0.038)
Rank=7, Name=ridge-0.8, Score=0.848 (+/- 0.038)
Rank=8, Name=ridge-0.7, Score=0.848 (+/- 0.038)
Rank=9, Name=ridge-0.6, Score=0.848 (+/- 0.038)
Rank=10, Name=ridge-0.5, Score=0.848 (+/- 0.038)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245a8547030750-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245a8547030750-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245a8547030750-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-2">&gt;bag: 0.861 (+/-0.037)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-3">&gt;rf: 0.859 (+/-0.036)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-4">&gt;et: 0.869 (+/-0.035)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-5">&gt;gbm: 0.867 (+/-0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-6"> </div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-7">Rank=1, Name=et, Score=0.869 (+/- 0.035)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-8">Rank=2, Name=gbm, Score=0.867 (+/- 0.044)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-9">Rank=3, Name=bag, Score=0.861 (+/- 0.037)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-10">Rank=4, Name=rf, Score=0.859 (+/- 0.036)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-11">Rank=5, Name=ada, Score=0.850 (+/- 0.035)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-12">Rank=6, Name=ridge-0.9, Score=0.848 (+/- 0.038)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-13">Rank=7, Name=ridge-0.8, Score=0.848 (+/- 0.038)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-14">Rank=8, Name=ridge-0.7, Score=0.848 (+/- 0.038)</div><div class="crayon-line" id="crayon-5c0ca424245a8547030750-15">Rank=9, Name=ridge-0.6, Score=0.848 (+/- 0.038)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245a8547030750-16">Rank=10, Name=ridge-0.5, Score=0.848 (+/- 0.038)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>There will still be some variance in the reported means, but less than a single run of k-fold cross-validation.</p>
<p>The number of repeats may be increased to further reduce this variance, at the cost of longer run times, and perhaps against the intent of spot checking.</p>
<h3>Varied Input Representations</h3>
<p>I am a big fan of avoiding assumptions and recommendations for data representations prior to fitting models.</p>
<p>Instead, I like to also spot-check multiple representations and transforms of input data, which I refer to as views. I explain this more in the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/how-to-get-the-most-from-your-machine-learning-data/">How to Get the Most From Your Machine Learning Data</a></li>
</ul>
<p>We can update the framework to spot-check multiple different representations for each model.</p>
<p>One way to do this is to update the <em>evaluate_models()</em> function so that we can provide a list of <em>make_pipeline()</em> functions that can be used for each defined model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245ab452908092" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, pipe_funcs, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate model under each preparation function
		for i in range(len(pipe_funcs)):
			# evaluate the model
			scores = robust_evaluate_model(X, y, model, folds, metric, pipe_funcs[i])
			# update name
			run_name = str(i) + name
			# show process
			if scores is not None:
				# store a result
				results[run_name] = scores
				mean_score, std_score = mean(scores), std(scores)
				print('&gt;%s: %.3f (+/-%.3f)' % (run_name, mean_score, std_score))
			else:
				print('&gt;%s: error' % run_name)
	return results</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-16">16</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ab452908092-18">18</div><div class="crayon-num" data-line="crayon-5c0ca424245ab452908092-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245ab452908092-1"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-3"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-5"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model under each preparation function</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-7"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-8"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-9"><span class="crayon-h"> </span><span class="crayon-p"># update name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-10"><span class="crayon-h"> </span><span class="crayon-v">run_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">name</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-11"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-12"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-13"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-14"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">run_name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-15"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-16"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">run_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-17"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ab452908092-18"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">run_name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ab452908092-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>The chosen pipeline function can then be passed along down to the <em>robust_evaluate_model()</em> function and to the <em>evaluate_model()</em> function where it can be used.</p>
<p>We can then define a bunch of different pipeline functions; for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245ad563512556" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# no transforms pipeline
def pipeline_none(model):
	return model

# standardize transform pipeline
def pipeline_standardize(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# normalize transform pipeline
def pipeline_normalize(model):
	steps = list()
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# standardize and normalize pipeline
def pipeline_std_norm(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-16">16</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-18">18</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-20">20</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-22">22</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-24">24</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-26">26</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-28">28</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-30">30</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-32">32</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-34">34</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-36">36</div><div class="crayon-num" data-line="crayon-5c0ca424245ad563512556-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245ad563512556-38">38</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245ad563512556-1"><span class="crayon-p"># no transforms pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-2"><span class="crayon-e">def </span><span class="crayon-e">pipeline_none</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-4"> </div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-5"><span class="crayon-p"># standardize transform pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-6"><span class="crayon-e">def </span><span class="crayon-e">pipeline_standardize</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-7"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-8"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-9"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-10"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-11"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-12"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-13"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-16"><span class="crayon-p"># normalize transform pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-17"><span class="crayon-e">def </span><span class="crayon-e">pipeline_normalize</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-18"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-19"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-20"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-21"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-22"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-23"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-24"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-25"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-26"> </div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-27"><span class="crayon-p"># standardize and normalize pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-28"><span class="crayon-e">def </span><span class="crayon-e">pipeline_std_norm</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-29"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-30"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-31"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-32"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-33"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-34"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-35"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-36"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245ad563512556-37"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245ad563512556-38"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Then create a list of these function names that can be provided to the <em>evaluate_models()</em> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245af144484401" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define transform pipelines
pipelines = [pipeline_none, pipeline_standardize, pipeline_normalize, pipeline_std_norm]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245af144484401-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245af144484401-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245af144484401-1"><span class="crayon-p"># define transform pipelines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245af144484401-2"><span class="crayon-v">pipelines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">pipeline_none</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_standardize</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_normalize</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_std_norm</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete example of the classification case updated to spot check pipeline transforms is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245b1842051111" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# binary classification spot check script
import warnings
from numpy import mean
from numpy import std
from matplotlib import pyplot
from sklearn.datasets import make_classification
from sklearn.model_selection import cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import MinMaxScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression
from sklearn.linear_model import RidgeClassifier
from sklearn.linear_model import SGDClassifier
from sklearn.linear_model import PassiveAggressiveClassifier
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.tree import ExtraTreeClassifier
from sklearn.svm import SVC
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import AdaBoostClassifier
from sklearn.ensemble import BaggingClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import ExtraTreesClassifier
from sklearn.ensemble import GradientBoostingClassifier

# load the dataset, returns X and y elements
def load_dataset():
	return make_classification(n_samples=1000, n_classes=2, random_state=1)

# create a dict of standard models to evaluate {name:object}
def define_models(models=dict()):
	# linear models
	models['logistic'] = LogisticRegression()
	alpha = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for a in alpha:
		models['ridge-'+str(a)] = RidgeClassifier(alpha=a)
	models['sgd'] = SGDClassifier(max_iter=1000, tol=1e-3)
	models['pa'] = PassiveAggressiveClassifier(max_iter=1000, tol=1e-3)
	# non-linear models
	n_neighbors = range(1, 21)
	for k in n_neighbors:
		models['knn-'+str(k)] = KNeighborsClassifier(n_neighbors=k)
	models['cart'] = DecisionTreeClassifier()
	models['extra'] = ExtraTreeClassifier()
	models['svml'] = SVC(kernel='linear')
	models['svmp'] = SVC(kernel='poly')
	c_values = [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
	for c in c_values:
		models['svmr'+str(c)] = SVC(C=c)
	models['bayes'] = GaussianNB()
	# ensemble models
	n_trees = 100
	models['ada'] = AdaBoostClassifier(n_estimators=n_trees)
	models['bag'] = BaggingClassifier(n_estimators=n_trees)
	models['rf'] = RandomForestClassifier(n_estimators=n_trees)
	models['et'] = ExtraTreesClassifier(n_estimators=n_trees)
	models['gbm'] = GradientBoostingClassifier(n_estimators=n_trees)
	print('Defined %d models' % len(models))
	return models

# no transforms pipeline
def pipeline_none(model):
	return model

# standardize transform pipeline
def pipeline_standardize(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# normalize transform pipeline
def pipeline_normalize(model):
	steps = list()
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# standardize and normalize pipeline
def pipeline_std_norm(model):
	steps = list()
	# standardization
	steps.append(('standardize', StandardScaler()))
	# normalization
	steps.append(('normalize', MinMaxScaler()))
	# the model
	steps.append(('model', model))
	# create pipeline
	pipeline = Pipeline(steps=steps)
	return pipeline

# evaluate a single model
def evaluate_model(X, y, model, folds, metric, pipe_func):
	# create the pipeline
	pipeline = pipe_func(model)
	# evaluate model
	scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)
	return scores

# evaluate a model and try to trap errors and and hide warnings
def robust_evaluate_model(X, y, model, folds, metric, pipe_func):
	scores = None
	try:
		with warnings.catch_warnings():
			warnings.filterwarnings("ignore")
			scores = evaluate_model(X, y, model, folds, metric, pipe_func)
	except:
		scores = None
	return scores

# evaluate a dict of models {name:object}, returns {name:score}
def evaluate_models(X, y, models, pipe_funcs, folds=10, metric='accuracy'):
	results = dict()
	for name, model in models.items():
		# evaluate model under each preparation function
		for i in range(len(pipe_funcs)):
			# evaluate the model
			scores = robust_evaluate_model(X, y, model, folds, metric, pipe_funcs[i])
			# update name
			run_name = str(i) + name
			# show process
			if scores is not None:
				# store a result
				results[run_name] = scores
				mean_score, std_score = mean(scores), std(scores)
				print('&gt;%s: %.3f (+/-%.3f)' % (run_name, mean_score, std_score))
			else:
				print('&gt;%s: error' % run_name)
	return results

# print and plot the top n results
def summarize_results(results, maximize=True, top_n=10):
	# check for no results
	if len(results) == 0:
		print('no results')
		return
	# determine how many results to summarize
	n = min(top_n, len(results))
	# create a list of (name, mean(scores)) tuples
	mean_scores = [(k,mean(v)) for k,v in results.items()]
	# sort tuples by mean score
	mean_scores = sorted(mean_scores, key=lambda x: x[1])
	# reverse for descending order (e.g. for accuracy)
	if maximize:
		mean_scores = list(reversed(mean_scores))
	# retrieve the top n for summarization
	names = [x[0] for x in mean_scores[:n]]
	scores = [results[x[0]] for x in mean_scores[:n]]
	# print the top n
	print()
	for i in range(n):
		name = names[i]
		mean_score, std_score = mean(results[name]), std(results[name])
		print('Rank=%d, Name=%s, Score=%.3f (+/- %.3f)' % (i+1, name, mean_score, std_score))
	# boxplot for the top n
	pyplot.boxplot(scores, labels=names)
	_, labels = pyplot.xticks()
	pyplot.setp(labels, rotation=90)
	pyplot.savefig('spotcheck.png')

# load dataset
X, y = load_dataset()
# get model list
models = define_models()
# define transform pipelines
pipelines = [pipeline_none, pipeline_standardize, pipeline_normalize, pipeline_std_norm]
# evaluate models
results = evaluate_models(X, y, models, pipelines)
# summarize results
summarize_results(results)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-16">16</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-18">18</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-20">20</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-22">22</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-24">24</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-26">26</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-28">28</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-30">30</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-32">32</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-34">34</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-36">36</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-38">38</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-40">40</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-42">42</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-44">44</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-46">46</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-48">48</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-50">50</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-52">52</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-54">54</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-56">56</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-58">58</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-60">60</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-62">62</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-64">64</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-66">66</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-68">68</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-70">70</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-72">72</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-74">74</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-76">76</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-78">78</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-80">80</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-82">82</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-84">84</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-86">86</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-88">88</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-90">90</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-92">92</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-94">94</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-96">96</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-98">98</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-100">100</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-102">102</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-104">104</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-106">106</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-108">108</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-110">110</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-112">112</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-114">114</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-116">116</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-118">118</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-120">120</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-122">122</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-124">124</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-126">126</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-128">128</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-130">130</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-132">132</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-134">134</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-136">136</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-138">138</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-140">140</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-142">142</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-144">144</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-146">146</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-148">148</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-150">150</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-152">152</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-154">154</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-156">156</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-158">158</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-160">160</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-162">162</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-164">164</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-166">166</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-168">168</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-170">170</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-172">172</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-174">174</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-176">176</div><div class="crayon-num" data-line="crayon-5c0ca424245b1842051111-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b1842051111-178">178</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245b1842051111-1"><span class="crayon-p"># binary classification spot check script</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-2"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">make_classification</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">MinMaxScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">RidgeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">SGDClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">PassiveAggressiveClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-15"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-16"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-17"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-18"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-19"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">naive_bayes </span><span class="crayon-e">import </span><span class="crayon-e">GaussianNB</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-20"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">AdaBoostClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-21"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-22"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-23"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">ExtraTreesClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-24"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-v">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-26"><span class="crayon-p"># load the dataset, returns X and y elements</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-27"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-28"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">make_classification</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_classes</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-30"><span class="crayon-p"># create a dict of standard models to evaluate {name:object}</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-31"><span class="crayon-e">def </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-o">=</span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-32"><span class="crayon-h"> </span><span class="crayon-p"># linear models</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-33"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'logistic'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-34"><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-35"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-36"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ridge-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-37"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'sgd'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-38"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'pa'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PassiveAggressiveClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_iter</span><span class="crayon-o">=</span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-o">=</span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-39"><span class="crayon-h"> </span><span class="crayon-p"># non-linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-40"><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-41"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">n_neighbors</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-42"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'knn-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-43"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'cart'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-44"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'extra'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-45"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svml'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-46"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmp'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'poly'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-47"><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-48"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">c_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-49"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'svmr'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-v">c</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-50"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bayes'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GaussianNB</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-51"><span class="crayon-h"> </span><span class="crayon-p"># ensemble models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-52"><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-53"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'ada'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">AdaBoostClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-54"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'bag'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-55"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'rf'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-56"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'et'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ExtraTreesClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-57"><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-s">'gbm'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-58"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Defined %d models'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-59"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-60"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-61"><span class="crayon-p"># no transforms pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-62"><span class="crayon-e">def </span><span class="crayon-e">pipeline_none</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-63"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-64"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-65"><span class="crayon-p"># standardize transform pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-66"><span class="crayon-e">def </span><span class="crayon-e">pipeline_standardize</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-67"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-68"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-69"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-70"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-71"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-72"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-73"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-74"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-75"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-76"><span class="crayon-p"># normalize transform pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-77"><span class="crayon-e">def </span><span class="crayon-e">pipeline_normalize</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-78"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-79"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-80"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-81"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-82"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-83"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-84"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-85"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-86"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-87"><span class="crayon-p"># standardize and normalize pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-88"><span class="crayon-e">def </span><span class="crayon-e">pipeline_std_norm</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-89"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-90"><span class="crayon-h"> </span><span class="crayon-p"># standardization</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-91"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'standardize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-92"><span class="crayon-h"> </span><span class="crayon-p"># normalization</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-93"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'normalize'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-94"><span class="crayon-h"> </span><span class="crayon-p"># the model</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-95"><span class="crayon-h"> </span><span class="crayon-v">steps</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-s">'model'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-96"><span class="crayon-h"> </span><span class="crayon-p"># create pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-97"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-v">steps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-98"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-99"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-100"><span class="crayon-p"># evaluate a single model</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-101"><span class="crayon-e">def </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_func</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-102"><span class="crayon-h"> </span><span class="crayon-p"># create the pipeline</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-103"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pipe_func</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-104"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-105"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-106"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-107"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-108"><span class="crayon-p"># evaluate a model and try to trap errors and and hide warnings</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-109"><span class="crayon-e">def </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_func</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-110"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-111"><span class="crayon-e"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-112"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">catch_warnings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-113"><span class="crayon-h"> </span><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-114"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_func</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-115"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-116"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-117"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-118"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-119"><span class="crayon-p"># evaluate a dict of models {name:object}, returns {name:score}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-120"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-121"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-122"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">model </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-123"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model under each preparation function</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-124"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-125"><span class="crayon-h"> </span><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-126"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">robust_evaluate_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipe_funcs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-127"><span class="crayon-h"> </span><span class="crayon-p"># update name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-128"><span class="crayon-h"> </span><span class="crayon-v">run_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">name</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-129"><span class="crayon-h"> </span><span class="crayon-p"># show process</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-130"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-131"><span class="crayon-h"> </span><span class="crayon-p"># store a result</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-132"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">run_name</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">scores</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-133"><span class="crayon-e"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-134"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: %.3f (+/-%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">run_name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-135"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-136"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%s: error'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">run_name</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-137"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-138"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-139"><span class="crayon-p"># print and plot the top n results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-140"><span class="crayon-e">def </span><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">top_n</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-141"><span class="crayon-h"> </span><span class="crayon-p"># check for no results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-142"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-143"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'no results'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-144"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-145"><span class="crayon-h"> </span><span class="crayon-p"># determine how many results to summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-146"><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">top_n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-147"><span class="crayon-h"> </span><span class="crayon-p"># create a list of (name, mean(scores)) tuples</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-148"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-149"><span class="crayon-h"> </span><span class="crayon-p"># sort tuples by mean score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-150"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-i">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-151"><span class="crayon-h"> </span><span class="crayon-p"># reverse for descending order (e.g. for accuracy)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-152"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">maximize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-153"><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-v">mean_scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-154"><span class="crayon-h"> </span><span class="crayon-p"># retrieve the top n for summarization</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-155"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-156"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">mean_scores</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-157"><span class="crayon-h"> </span><span class="crayon-p"># print the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-158"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-159"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-160"><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-161"><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">name</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-162"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Rank=%d, Name=%s, Score=%.3f (+/- %.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-163"><span class="crayon-h"> </span><span class="crayon-p"># boxplot for the top n</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-164"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-165"><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-166"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">setp</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-167"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'spotcheck.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-168"> </div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-169"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-170"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-171"><span class="crayon-p"># get model list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-172"><span class="crayon-v">models</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_models</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-173"><span class="crayon-p"># define transform pipelines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-174"><span class="crayon-v">pipelines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">pipeline_none</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_standardize</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_normalize</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipeline_std_norm</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-175"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-176"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pipelines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca424245b1842051111-177"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b1842051111-178"><span class="crayon-e">summarize_results</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0092 seconds] -->
<p>Running the example shows that we differentiate the results for each pipeline by adding the pipeline number to the beginning of the algorithm description name, e.g. ‘<em>0rf</em>‘ means RF with the first pipeline, which is no transforms.</p>
<p>The ensembles of trees algorithms perform well on this problem, and these algorithms are invariant to data scaling. This means that their results on each pipeline will be similar (or the same) and in turn they will crowd out other algorithms in the top-10 list.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca424245b3615372680" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
&gt;0gbm: 0.865 (+/-0.044)
&gt;1gbm: 0.865 (+/-0.044)
&gt;2gbm: 0.865 (+/-0.044)
&gt;3gbm: 0.865 (+/-0.044)

Rank=1, Name=3rf, Score=0.870 (+/- 0.034)
Rank=2, Name=2rf, Score=0.870 (+/- 0.034)
Rank=3, Name=1rf, Score=0.870 (+/- 0.034)
Rank=4, Name=0rf, Score=0.870 (+/- 0.034)
Rank=5, Name=3bag, Score=0.866 (+/- 0.039)
Rank=6, Name=2bag, Score=0.866 (+/- 0.039)
Rank=7, Name=1bag, Score=0.866 (+/- 0.039)
Rank=8, Name=0bag, Score=0.866 (+/- 0.039)
Rank=9, Name=3gbm, Score=0.865 (+/- 0.044)
Rank=10, Name=2gbm, Score=0.865 (+/- 0.044)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-2">2</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-4">4</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-6">6</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-8">8</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-10">10</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-12">12</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-14">14</div><div class="crayon-num" data-line="crayon-5c0ca424245b3615372680-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca424245b3615372680-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca424245b3615372680-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-2">&gt;0gbm: 0.865 (+/-0.044)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-3">&gt;1gbm: 0.865 (+/-0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-4">&gt;2gbm: 0.865 (+/-0.044)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-5">&gt;3gbm: 0.865 (+/-0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-6"> </div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-7">Rank=1, Name=3rf, Score=0.870 (+/- 0.034)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-8">Rank=2, Name=2rf, Score=0.870 (+/- 0.034)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-9">Rank=3, Name=1rf, Score=0.870 (+/- 0.034)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-10">Rank=4, Name=0rf, Score=0.870 (+/- 0.034)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-11">Rank=5, Name=3bag, Score=0.866 (+/- 0.039)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-12">Rank=6, Name=2bag, Score=0.866 (+/- 0.039)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-13">Rank=7, Name=1bag, Score=0.866 (+/- 0.039)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-14">Rank=8, Name=0bag, Score=0.866 (+/- 0.039)</div><div class="crayon-line" id="crayon-5c0ca424245b3615372680-15">Rank=9, Name=3gbm, Score=0.865 (+/- 0.044)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca424245b3615372680-16">Rank=10, Name=2gbm, Score=0.865 (+/- 0.044)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<ul>
<li><a href="https://machinelearningmastery.com/why-you-should-be-spot-checking-algorithms-on-your-machine-learning-problems/">Why you should be Spot-Checking Algorithms on your Machine Learning Problems</a></li>
<li><a href="https://machinelearningmastery.com/spot-check-classification-machine-learning-algorithms-python-scikit-learn/">Spot-Check Classification Machine Learning Algorithms in Python with scikit-learn</a></li>
<li><a href="https://machinelearningmastery.com/spot-check-regression-machine-learning-algorithms-python-scikit-learn/">Spot-Check Regression Machine Learning Algorithms in Python with scikit-learn</a></li>
<li><a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/">How to Evaluate the Skill of Deep Learning Models</a></li>
<li><a href="https://machinelearningmastery.com/applied-machine-learning-is-hard/">Why Applied Machine Learning Is Hard</a></li>
<li><a href="https://machinelearningmastery.com/applied-machine-learning-as-a-search-problem/">A Gentle Introduction to Applied Machine Learning as a Search Problem</a></li>
<li><a href="https://machinelearningmastery.com/how-to-get-the-most-from-your-machine-learning-data/">How to Get the Most From Your Machine Learning Data</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered the usefulness of spot-checking algorithms on a new predictive modeling problem and how to develop a standard framework for spot-checking algorithms in python for classification and regression problems.</p>
<p>Specifically, you learned:</p>
<ul>
<li>Spot-checking provides a way to quickly discover the types of algorithms that perform well on your predictive modeling problem.</li>
<li>How to develop a generic framework for loading data, defining models, evaluating models, and summarizing results.</li>
<li>How to apply the framework for classification and regression problems.</li>
</ul>
<p>Have you used this framework or do you have some further suggestions to improve it?<br/>
Let me know in the comments.</p>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-38"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><center>
<h2>Frustrated With Python Machine Learning?</h2>
<p><a href="/machine-learning-with-python/"><img align="left" alt="Master Machine Learning With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/07/MachineLearningMasteryWithPython-220px.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Models in Minutes</h4>
<p>…with just a few lines of scikit-learn code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/machine-learning-with-python/">Machine Learning Mastery With Python</a></p>
<p>Covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> like:<br/>
<em>Loading data</em>, <em>visualization</em>, <em>modeling</em>, <em>tuning</em>, and much more…</p>
<h4>Finally Bring Machine Learning To<br/>
Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/machine-learning-with-python/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div></center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6184 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Reusable+Framework+to+Spot-Check+Algorithms+in+Python&amp;url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-load-and-explore-a-standard-human-activity-recognition-problem/" rel="prev"><i class="fa fa-angle-left"></i> A Gentle Introduction to a Standard Human Activity Recognition Problem</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-model-human-activity-from-smartphone-data/" rel="next">How to Model Human Activity From Smartphone Data <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">18 Responses to <em>How to Develop a Reusable Framework to Spot-Check Algorithms in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-448756">
<div class="comment-container" id="li-comment-448756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f66642bd257ba1bc8a393bf162ee2f61?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f66642bd257ba1bc8a393bf162ee2f61?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris wong</span>
<span class="date">September 14, 2018 at 11:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason,<br/>
have you tried using the autoML tools such as autoKeras &amp; Auto-sklearn packages?<br/>
(I’ve also used AutoWeka in the weka package – very limited, and Rapidminer Auto-Modelling).</p>
<p>c</p>
<div class="reply">
<a aria-label="Reply to Chris wong" class="comment-reply-link" href="#comment-448756" onclick='return addComment.moveForm( "comment-448756", "448756", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448775">
<div class="comment-container" id="li-comment-448775">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448775" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I generally don’t use them. Have you?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448775" onclick='return addComment.moveForm( "comment-448775", "448775", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-448764">
<div class="comment-container" id="li-comment-448764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3950badde63035bb9904b49bc08d3bf4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3950badde63035bb9904b49bc08d3bf4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Richard</span>
<span class="date">September 14, 2018 at 1:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is this possible in R?</p>
<div class="reply">
<a aria-label="Reply to Richard" class="comment-reply-link" href="#comment-448764" onclick='return addComment.moveForm( "comment-448764", "448764", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448776">
<div class="comment-container" id="li-comment-448776">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448776" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, with the caret package.</p>
<p>I even have examples on the blog, search “spot check”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448776" onclick='return addComment.moveForm( "comment-448776", "448776", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-448785">
<div class="comment-container" id="li-comment-448785">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2fc5c229a4ee18415000370f469635f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2fc5c229a4ee18415000370f469635f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jurek</span>
<span class="date">September 14, 2018 at 4:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448785" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is truly one of the best resources for ML on the web</p>
<div class="reply">
<a aria-label="Reply to Jurek" class="comment-reply-link" href="#comment-448785" onclick='return addComment.moveForm( "comment-448785", "448785", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448850">
<div class="comment-container" id="li-comment-448850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m happy it helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448850" onclick='return addComment.moveForm( "comment-448850", "448850", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-448794">
<div class="comment-container" id="li-comment-448794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80f21d4b713628c01cb8ec7727ae5d7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80f21d4b713628c01cb8ec7727ae5d7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Raj</span>
<span class="date">September 14, 2018 at 5:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir, </p>
<p>Awesome post on spot checking algorithm. This is really a great one – one stop shop!</p>
<p>I have couple of basic questions here – </p>
<p>1) How the similar approach along with pipeline can be applied to different Keras models -sequential, functional and KerasRegressor/KerasClassifier (with layers/dropouts/optimizers etc.)? </p>
<p>2) Do we need to reset states/layers in evaluate models prior to build/apply pipeline?</p>
<p>3) Post evaluation and finalizing the model, do we need to rebuild model, compile, fit to predict the test dataset or use the existing compiled model to fit and predict? Will predicted values/scores vary for each runs due to different weight initializations?</p>
<p>Thanking you in anticipation for your response.</p>
<div class="reply">
<a aria-label="Reply to Raj" class="comment-reply-link" href="#comment-448794" onclick='return addComment.moveForm( "comment-448794", "448794", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448852">
<div class="comment-container" id="li-comment-448852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Neural nets might be too big/slow for this type of framework and you may have to grid search manually.</p>
<p>Regardless of model, you should redefine and refit for each eval.</p>
<p>A finalized model is refit on all available data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448852" onclick='return addComment.moveForm( "comment-448852", "448852", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-448935">
<div class="comment-container" id="li-comment-448935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/168482f6a48c15d0cf0643f108559e48?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/168482f6a48c15d0cf0643f108559e48?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rohit</span>
<span class="date">September 15, 2018 at 7:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello sir this is the best article on spot checking algorithm , I have a little doubt about the Box and whisker plot.<br/>
Could you please explain what are the things the box plot is showing beside scores?</p>
<div class="reply">
<a aria-label="Reply to Rohit" class="comment-reply-link" href="#comment-448935" onclick='return addComment.moveForm( "comment-448935", "448935", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448993">
<div class="comment-container" id="li-comment-448993">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448993" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>The boxplot summarizes the distribution of scores for each algorithm and allows simple comparison between the distributions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448993" onclick='return addComment.moveForm( "comment-448993", "448993", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-448937">
<div class="comment-container" id="li-comment-448937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/376be2f3e44911dd1667024346c0c31d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/376be2f3e44911dd1667024346c0c31d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mansoor</span>
<span class="date">September 15, 2018 at 7:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good well rounded post.<br/>
Would really appreciate similar spot checking for (not too deep) neural nets framework in keras or tensorflow.</p>
<div class="reply">
<a aria-label="Reply to Mansoor" class="comment-reply-link" href="#comment-448937" onclick='return addComment.moveForm( "comment-448937", "448937", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448994">
<div class="comment-container" id="li-comment-448994">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-448994" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>Great suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448994" onclick='return addComment.moveForm( "comment-448994", "448994", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-449718">
<div class="comment-container" id="li-comment-449718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f173f245cecc4351c62cccd897607777?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f173f245cecc4351c62cccd897607777?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">George</span>
<span class="date">September 25, 2018 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-449718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post. As always 🙂</p>
<div class="reply">
<a aria-label="Reply to George" class="comment-reply-link" href="#comment-449718" onclick='return addComment.moveForm( "comment-449718", "449718", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449738">
<div class="comment-container" id="li-comment-449738">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-449738" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449738" onclick='return addComment.moveForm( "comment-449738", "449738", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450383">
<div class="comment-container" id="li-comment-450383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e98d18927f695fa18821410300f23c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e98d18927f695fa18821410300f23c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deva</span>
<span class="date">October 1, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-450383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great Article sir !! Sir consider creating you tube channel for you with all your contents!!.. It would help millions.</p>
<div class="reply">
<a aria-label="Reply to Deva" class="comment-reply-link" href="#comment-450383" onclick='return addComment.moveForm( "comment-450383", "450383", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450387">
<div class="comment-container" id="li-comment-450387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 1, 2018 at 2:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-450387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450387" onclick='return addComment.moveForm( "comment-450387", "450387", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-456845">
<div class="comment-container" id="li-comment-456845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JG</span>
<span class="date">December 1, 2018 at 11:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-456845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very rich an complete post Jason!. I hope to have enough  time to go through all the spot check algorithms included details !.Thanks</p>
<p>Anyway in a fast reading I appreciate this tip for  hardware with many cores (as it is my case):</p>
<p>“Importantly, the n_jobs argument is set to -1 to allow the model evaluations to occur in parallel, harnessing as many cores as you have available on your hardware”.<br/>
scores = cross_val_score(pipeline, X, y, scoring=metric, cv=folds, n_jobs=-1)</p>
<p>Also I understand that these Spot Check techniques are applicable when the model fit is very short, because if not (as it is the case of big dataset, training, epochs, etc. or more complex models) …this a problem intractable by spot check</p>
<div class="reply">
<a aria-label="Reply to JG" class="comment-reply-link" href="#comment-456845" onclick='return addComment.moveForm( "comment-456845", "456845", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-456897">
<div class="comment-container" id="li-comment-456897">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/spot-check-machine-learning-algorithms-in-python/#comment-456897" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>Yes, for large datasets there is benefit is using a small sample to ensure the process is timely.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456897" onclick='return addComment.moveForm( "comment-456897", "456897", "respond", "6184" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/spot-check-machine-learning-algorithms-in-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="6184"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="efde0e44de"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="40"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-10"> <div class="textwidget"><p></p><center><br/>
<strong>Machine Learning with Python</strong><br/>
Develop predictive models with scikit-learn.
<p><a href="/machine-learning-with-python/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/07/MachineLearningMasteryWithPython-220px.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>